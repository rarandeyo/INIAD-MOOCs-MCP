# INIAD MOOCs 課題提出・操作プロンプトテンプレート

## 目的

INIAD MOOCs 上の特定の操作（講義資料の閲覧、課題/練習問題の確認・提出など）を実行する。

## 前提条件
-   操作に必要な情報（コース名、講義名、課題/練習問題名、提出内容、ファイルパスなど）が提供されていること。

## 基本的な処理フロー

1.  **目標の明確化**: ユーザーの指示から、最終的な目標（例: 「プログラミング1 第3回 練習問題」にファイル `kadai3.ipynb` を提出する）を特定する。

2.  **現在地の確認と移動 (Navigate & List)**:
    *   **URLが指定されている場合**: `browser_navigate` で直接そのURLに移動する。
        *   移動後、ログインページにリダイレクトされた場合は、ステップ3に進む。
        *   移動後のページに応じて、`navigate` が自動的にリスト（コース、講義、スライド）を取得する場合がある。結果を確認する。
    *   **URLが指定されていない場合**:
        *   まず `https://moocs.iniad.org/courses` に `browser_navigate` で移動する。
        *   `navigate` の結果に含まれるコースリストから、目的のコース名を探し、そのURLを特定する。
        *   特定したコースURLに `browser_navigate` で移動する。
        *   `navigate` の結果に含まれる講義リストから、目的の講義名や課題/練習問題名を探し、そのURLを特定する。
        *   特定した講義、課題/練習問題URLに `browser_navigate` で移動する。（最終目的地）
        *   （必要に応じて）移動後の `navigate` の結果に含まれるスライドリストから、目的のスライドURLを特定し、さらに `browser_navigate` で移動する。
    *   **移動失敗時の対応**: いずれかの `navigate` が失敗し、ログインページらしき場所に遷移した場合（URLやスナップショットで判断）、ステップ3に進む。

3.  **ログイン処理 (Login)**:
    *   ログインが必要と判断された場合（ステップ2でログインページに遷移した場合など）、`loginToIniadMoocsWithIniadAccount` を実行する。
    *   ログイン成功後、本来の目的地のURL（ステップ2で目指していたURL）へ再度 `browser_navigate` を試みる。

4.  **課題/練習問題内容の確認 (Snapshot)**:
    *   ユーザーから提出内容（テキスト、ファイルパスなど）が**指定されていない**場合、または課題/練習問題の詳細を確認する必要がある場合：
        *   まず、直前の `browser_navigate` で取得されたスナップショットが存在するか確認する。
        *   スナップショットが存在し、内容が最新であると判断できる場合は、それを分析する。
        *   スナップショットが存在しない、古い、またはページが動的に変化した可能性がある場合は、`browser_snapshot` を実行して最新のスナップショットを取得し、それを分析する。
        *   取得・分析したスナップショットの内容から、課題/練習問題の指示（入力フィールド、必要なファイル、提出ボタンなど）を確認する。
        *   確認結果をユーザーに提示し、提出内容の指示を仰ぐか、可能であれば内容を推測して次のステップに進む。

5.  **課題/練習問題提出処理 (Submit Assignment)**:
    *   提出内容と提出先の要素（入力フィールドのref、提出ボタンのrefなど）が確定している場合：
        *   直前の `navigate`で取得された**最新のスナップショット**に基づいて、`submit_assignment` ツールに必要なパラメータ（`operations` 配列と `submitButtonRef`）を組み立てる。`navigate` で取得したsnapshotを利用した処理が失敗した場合のみ、`browser_snapshot` を実行して最新のスナップショットを取得する。
            *   `operations` には、テキスト入力 (`type`)、ファイルアップロード (`upload`) などの操作を、スナップショットから得られた `ref` と共に指定する。
            *   ファイルパスは、ユーザー指定のパス、またはワークスペース内の適切なパスを使用する。
        *   `submit_assignment` を実行する。
6.  **他の未提出課題/練習問題の確認 (任意)**:
    *   提出処理後、現在のコースの講義一覧ページに `browser_navigate` で移動する（既にいる場合は不要）。
    *   `navigate` の結果に含まれる講義リストとスナップショット（または必要なら `browser_snapshot` で最新化）を確認する。
    *   スナップショットから各課題/練習問題の提出状況（例: "提出済み"、"未提出"、特定のアイコンなど）を識別する。
    *   今回提出したもの以外に未提出の課題/練習問題があれば、そのリストを作成する。

7.  **完了報告**:
    *   全ての操作が完了したら、最終的な結果（例: 課題/練習問題の提出完了、指定ページの表示完了など）をユーザーに報告する。
    *   ステップ6で未提出の課題/練習問題リストが作成された場合は、その情報も併せて報告する。（例: 「提出が完了しました。なお、このコースには他に以下の未提出課題があります: [課題名1, 課題名2]」）

